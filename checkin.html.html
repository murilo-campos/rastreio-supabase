<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Check-in Entregador</title>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
</head>
<body>
  <h2>Check-in Entregador</h2>
  <input type="text" id="nome" placeholder="Digite seu nome" />
  <button onclick="fazerCheckin()">Fazer Check-in</button>

  <script>
    const supabase = supabase.createClient(
      'https://aheehrciioihfsgllpvv.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFoZWVocmNpaW9paGZzZ2xscHZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk1MTMyMTksImV4cCI6MjA2NTA4OTIxOX0.LVrCy6UAU4hPo68syWbHmUn8Hmpyj4ekNm_fx0QTULY'
    );

    function fazerCheckin() {
      const nome = document.getElementById('nome').value.trim();
      if (!nome) return alert('Digite seu nome');
      if (!navigator.geolocation) return alert('Geolocalização não suportada.');

      navigator.geolocation.getCurrentPosition(async pos => {
        const { latitude, longitude } = pos.coords;
        await supabase.from('entregadores').upsert({
          nome: nome,
          lat: latitude,
          lng: longitude,
          atualizado_em: new Date().toISOString()
        });
        document.body.innerHTML = "<h2>Check-in realizado com sucesso!</h2>";
      }, err => alert('Erro ao obter localização: ' + err.message));
    }
  </script>
</body>
</html>
